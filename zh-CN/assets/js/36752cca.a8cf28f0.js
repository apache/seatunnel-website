"use strict";(self.webpackChunkseatunnel_website=self.webpackChunkseatunnel_website||[]).push([[19457],{15680:(e,n,t)=>{t.d(n,{xA:()=>m,yg:()=>h});var a=t(96540);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,i=function(e,n){if(null==e)return{};var t,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=a.createContext({}),d=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},m=function(e){var n=d(e.components);return a.createElement(s.Provider,{value:n},e.children)},u="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},p=a.forwardRef((function(e,n){var t=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=d(t),p=i,h=u["".concat(s,".").concat(p)]||u[p]||g[p]||r;return t?a.createElement(h,o(o({ref:n},m),{},{components:t})):a.createElement(h,o({ref:n},m))}));function h(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var r=t.length,o=new Array(r);o[0]=p;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[u]="string"==typeof e?e:i,o[1]=l;for(var d=2;d<r;d++)o[d]=t[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},6024:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>g,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var a=t(58168),i=(t(96540),t(15680));const r={},o="Embedding",l={unversionedId:"transform-v2/embedding",id:"version-2.3.8/transform-v2/embedding",title:"Embedding",description:"Embedding Transform Plugin",source:"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-2.3.8/transform-v2/embedding.md",sourceDirName:"transform-v2",slug:"/transform-v2/embedding",permalink:"/zh-CN/docs/2.3.8/transform-v2/embedding",draft:!1,editUrl:"https://github.com/apache/seatunnel-website/edit/main/i18n/zh-CN/docusaurus-plugin-content-docs/version-2.3.8/transform-v2/embedding.md",tags:[],version:"2.3.8",frontMatter:{},sidebar:"docs",previous:{title:"DynamicCompile",permalink:"/zh-CN/docs/2.3.8/transform-v2/dynamic-compile"},next:{title:"\u5b57\u6bb5\u6620\u5c04",permalink:"/zh-CN/docs/2.3.8/transform-v2/field-mapper"}},s={},d=[{value:"\u63cf\u8ff0",id:"\u63cf\u8ff0",level:2},{value:"\u914d\u7f6e\u9009\u9879",id:"\u914d\u7f6e\u9009\u9879",level:2},{value:"embedding_model_provider",id:"embedding_model_provider",level:3},{value:"api_key",id:"api_key",level:3},{value:"secret_key",id:"secret_key",level:3},{value:"single_vectorized_input_number",id:"single_vectorized_input_number",level:3},{value:"vectorization_fields",id:"vectorization_fields",level:3},{value:"model",id:"model",level:3},{value:"api_path",id:"api_path",level:3},{value:"oauth_path",id:"oauth_path",level:3},{value:"custom_config",id:"custom_config",level:3},{value:"custom_response_parse",id:"custom_response_parse",level:3},{value:"custom_request_headers",id:"custom_request_headers",level:3},{value:"custom_request_body",id:"custom_request_body",level:3},{value:"common options",id:"common-options",level:3},{value:"\u793a\u4f8b\u914d\u7f6e",id:"\u793a\u4f8b\u914d\u7f6e",level:2},{value:"Customize the embedding model",id:"customize-the-embedding-model",level:3}],m={toc:d},u="wrapper";function g(e){let{components:n,...t}=e;return(0,i.yg)(u,(0,a.A)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"embedding"},"Embedding"),(0,i.yg)("blockquote",null,(0,i.yg)("p",{parentName:"blockquote"},"Embedding Transform Plugin")),(0,i.yg)("h2",{id:"\u63cf\u8ff0"},"\u63cf\u8ff0"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"Embedding")," \u8f6c\u6362\u63d2\u4ef6\u5229\u7528 embedding \u6a21\u578b\u5c06\u6587\u672c\u6570\u636e\u8f6c\u6362\u4e3a\u5411\u91cf\u5316\u8868\u793a\u3002\u6b64\u8f6c\u6362\u53ef\u4ee5\u5e94\u7528\u4e8e\u5404\u79cd\u5b57\u6bb5\u3002\u8be5\u63d2\u4ef6\u652f\u6301\u591a\u79cd\u6a21\u578b\u63d0\u4f9b\u5546\uff0c\u5e76\u4e14\u53ef\u4ee5\u4e0e\u4e0d\u540c\u7684API\u96c6\u6210\u3002"),(0,i.yg)("h2",{id:"\u914d\u7f6e\u9009\u9879"},"\u914d\u7f6e\u9009\u9879"),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,i.yg)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,i.yg)("th",{parentName:"tr",align:null},"\u662f\u5426\u5fc5\u586b"),(0,i.yg)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"),(0,i.yg)("th",{parentName:"tr",align:null},"\u63cf\u8ff0"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"model_provider"),(0,i.yg)("td",{parentName:"tr",align:null},"enum"),(0,i.yg)("td",{parentName:"tr",align:null},"\u662f"),(0,i.yg)("td",{parentName:"tr",align:null},"-"),(0,i.yg)("td",{parentName:"tr",align:null},"embedding\u6a21\u578b\u7684\u63d0\u4f9b\u5546\u3002\u53ef\u9009\u9879\u5305\u62ec ",(0,i.yg)("inlineCode",{parentName:"td"},"QIANFAN"),"\u3001",(0,i.yg)("inlineCode",{parentName:"td"},"OPENAI")," \u7b49\u3002")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"api_key"),(0,i.yg)("td",{parentName:"tr",align:null},"string"),(0,i.yg)("td",{parentName:"tr",align:null},"\u662f"),(0,i.yg)("td",{parentName:"tr",align:null},"-"),(0,i.yg)("td",{parentName:"tr",align:null},"\u7528\u4e8e\u9a8c\u8bc1embedding\u670d\u52a1\u7684API\u5bc6\u94a5\u3002")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"secret_key"),(0,i.yg)("td",{parentName:"tr",align:null},"string"),(0,i.yg)("td",{parentName:"tr",align:null},"\u662f"),(0,i.yg)("td",{parentName:"tr",align:null},"-"),(0,i.yg)("td",{parentName:"tr",align:null},"\u7528\u4e8e\u989d\u5916\u9a8c\u8bc1\u7684\u5bc6\u94a5\u3002\u4e00\u4e9b\u63d0\u4f9b\u5546\u53ef\u80fd\u9700\u8981\u6b64\u5bc6\u94a5\u8fdb\u884c\u5b89\u5168\u7684API\u8bf7\u6c42\u3002")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"single_vectorized_input_number"),(0,i.yg)("td",{parentName:"tr",align:null},"int"),(0,i.yg)("td",{parentName:"tr",align:null},"\u5426"),(0,i.yg)("td",{parentName:"tr",align:null},"1"),(0,i.yg)("td",{parentName:"tr",align:null},"\u5355\u6b21\u8bf7\u6c42\u5411\u91cf\u5316\u7684\u8f93\u5165\u6570\u91cf\u3002\u9ed8\u8ba4\u503c\u4e3a1\u3002")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"vectorization_fields"),(0,i.yg)("td",{parentName:"tr",align:null},"map"),(0,i.yg)("td",{parentName:"tr",align:null},"\u662f"),(0,i.yg)("td",{parentName:"tr",align:null},"-"),(0,i.yg)("td",{parentName:"tr",align:null},"\u8f93\u5165\u5b57\u6bb5\u548c\u76f8\u5e94\u7684\u8f93\u51fa\u5411\u91cf\u5b57\u6bb5\u4e4b\u95f4\u7684\u6620\u5c04\u3002")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"model"),(0,i.yg)("td",{parentName:"tr",align:null},"string"),(0,i.yg)("td",{parentName:"tr",align:null},"\u662f"),(0,i.yg)("td",{parentName:"tr",align:null},"-"),(0,i.yg)("td",{parentName:"tr",align:null},"\u8981\u4f7f\u7528\u7684\u5177\u4f53embedding\u6a21\u578b\u3002\u4f8b\u5982\uff0c\u5982\u679c\u63d0\u4f9b\u5546\u4e3aOPENAI\uff0c\u53ef\u4ee5\u6307\u5b9a ",(0,i.yg)("inlineCode",{parentName:"td"},"text-embedding-3-small"),"\u3002")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"api_path"),(0,i.yg)("td",{parentName:"tr",align:null},"string"),(0,i.yg)("td",{parentName:"tr",align:null},"\u5426"),(0,i.yg)("td",{parentName:"tr",align:null},"-"),(0,i.yg)("td",{parentName:"tr",align:null},"embedding\u670d\u52a1\u7684API\u3002\u901a\u5e38\u7531\u6a21\u578b\u63d0\u4f9b\u5546\u63d0\u4f9b\u3002")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"oauth_path"),(0,i.yg)("td",{parentName:"tr",align:null},"string"),(0,i.yg)("td",{parentName:"tr",align:null},"\u5426"),(0,i.yg)("td",{parentName:"tr",align:null},"-"),(0,i.yg)("td",{parentName:"tr",align:null},"oauth \u670d\u52a1\u7684 API \u3002")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"custom_config"),(0,i.yg)("td",{parentName:"tr",align:null},"map"),(0,i.yg)("td",{parentName:"tr",align:null},"\u5426"),(0,i.yg)("td",{parentName:"tr",align:null}),(0,i.yg)("td",{parentName:"tr",align:null},"\u6a21\u578b\u7684\u81ea\u5b9a\u4e49\u914d\u7f6e\u3002")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"custom_response_parse"),(0,i.yg)("td",{parentName:"tr",align:null},"string"),(0,i.yg)("td",{parentName:"tr",align:null},"\u5426"),(0,i.yg)("td",{parentName:"tr",align:null}),(0,i.yg)("td",{parentName:"tr",align:null},"\u4f7f\u7528 JsonPath \u89e3\u6790\u6a21\u578b\u54cd\u5e94\u7684\u65b9\u5f0f\u3002\u793a\u4f8b\uff1a",(0,i.yg)("inlineCode",{parentName:"td"},"$.choices[*].message.content"),"\u3002")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"custom_request_headers"),(0,i.yg)("td",{parentName:"tr",align:null},"map"),(0,i.yg)("td",{parentName:"tr",align:null},"\u5426"),(0,i.yg)("td",{parentName:"tr",align:null}),(0,i.yg)("td",{parentName:"tr",align:null},"\u53d1\u9001\u5230\u6a21\u578b\u7684\u8bf7\u6c42\u7684\u81ea\u5b9a\u4e49\u5934\u4fe1\u606f\u3002")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"custom_request_body"),(0,i.yg)("td",{parentName:"tr",align:null},"map"),(0,i.yg)("td",{parentName:"tr",align:null},"\u5426"),(0,i.yg)("td",{parentName:"tr",align:null}),(0,i.yg)("td",{parentName:"tr",align:null},"\u8bf7\u6c42\u4f53\u7684\u81ea\u5b9a\u4e49\u914d\u7f6e\u3002\u652f\u6301\u5360\u4f4d\u7b26\u5982 ",(0,i.yg)("inlineCode",{parentName:"td"},"${model}"),"\u3001",(0,i.yg)("inlineCode",{parentName:"td"},"${input}"),"\u3002")))),(0,i.yg)("h3",{id:"embedding_model_provider"},"embedding_model_provider"),(0,i.yg)("p",null,"\u7528\u4e8e\u751f\u6210 embedding \u7684\u6a21\u578b\u63d0\u4f9b\u5546\u3002\u5e38\u89c1\u9009\u9879\u5305\u62ec ",(0,i.yg)("inlineCode",{parentName:"p"},"DOUBAO"),"\u3001",(0,i.yg)("inlineCode",{parentName:"p"},"QIANFAN"),"\u3001",(0,i.yg)("inlineCode",{parentName:"p"},"OPENAI")," \u7b49\uff0c\u540c\u65f6\u53ef\u9009\u62e9 ",(0,i.yg)("inlineCode",{parentName:"p"},"CUSTOM")," \u5b9e\u73b0\u81ea\u5b9a\u4e49 embedding\n\u6a21\u578b\u7684\u8bf7\u6c42\u4ee5\u53ca\u83b7\u53d6\u3002"),(0,i.yg)("h3",{id:"api_key"},"api_key"),(0,i.yg)("p",null,"\u7528\u4e8e\u9a8c\u8bc1 embedding \u670d\u52a1\u8bf7\u6c42\u7684API\u5bc6\u94a5\u3002\u901a\u5e38\u7531\u6a21\u578b\u63d0\u4f9b\u5546\u5728\u4f60\u6ce8\u518c\u4ed6\u4eec\u7684\u670d\u52a1\u65f6\u63d0\u4f9b\u3002"),(0,i.yg)("h3",{id:"secret_key"},"secret_key"),(0,i.yg)("p",null,"\u7528\u4e8e\u989d\u5916\u9a8c\u8bc1\u7684\u5bc6\u94a5\u3002\u4e00\u4e9b\u63d0\u4f9b\u5546\u53ef\u80fd\u8981\u6c42\u6b64\u5bc6\u94a5\u4ee5\u786e\u4fddAPI\u8bf7\u6c42\u7684\u5b89\u5168\u6027\u3002"),(0,i.yg)("h3",{id:"single_vectorized_input_number"},"single_vectorized_input_number"),(0,i.yg)("p",null,"\u6307\u5b9a\u5355\u6b21\u8bf7\u6c42\u5411\u91cf\u5316\u7684\u8f93\u5165\u6570\u91cf\u3002\u9ed8\u8ba4\u503c\u4e3a1\u3002\u6839\u636e\u5904\u7406\u80fd\u529b\u548c\u6a21\u578b\u63d0\u4f9b\u5546\u7684API\u9650\u5236\u8fdb\u884c\u8c03\u6574\u3002"),(0,i.yg)("h3",{id:"vectorization_fields"},"vectorization_fields"),(0,i.yg)("p",null,"\u8f93\u5165\u5b57\u6bb5\u548c\u76f8\u5e94\u7684\u8f93\u51fa\u5411\u91cf\u5b57\u6bb5\u4e4b\u95f4\u7684\u6620\u5c04\u3002\u8fd9\u4f7f\u5f97\u63d2\u4ef6\u53ef\u4ee5\u7406\u89e3\u8981\u5411\u91cf\u5316\u7684\u6587\u672c\u5b57\u6bb5\u4ee5\u53ca\u5982\u4f55\u5b58\u50a8\u751f\u6210\u7684\u5411\u91cf\u3002"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-hocon"},"vectorization_fields {\n    book_intro_vector = book_intro\n    author_biography_vector  = author_biography\n}\n")),(0,i.yg)("h3",{id:"model"},"model"),(0,i.yg)("p",null,"\u8981\u4f7f\u7528\u7684\u5177\u4f53 embedding \u6a21\u578b\u3002\u8fd9\u53d6\u51b3\u4e8e",(0,i.yg)("inlineCode",{parentName:"p"},"embedding_model_provider"),"\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f7f\u7528 OPENAI \uff0c\u53ef\u4ee5\u6307\u5b9a ",(0,i.yg)("inlineCode",{parentName:"p"},"text-embedding-3-small"),"\u3002"),(0,i.yg)("h3",{id:"api_path"},"api_path"),(0,i.yg)("p",null,"\u7528\u4e8e\u5411 embedding \u670d\u52a1\u53d1\u9001\u8bf7\u6c42\u7684API\u3002\u6839\u636e\u63d0\u4f9b\u5546\u548c\u6240\u7528\u6a21\u578b\u7684\u4e0d\u540c\u53ef\u80fd\u6709\u6240\u53d8\u5316\u3002\u901a\u5e38\u7531\u6a21\u578b\u63d0\u4f9b\u5546\u63d0\u4f9b\u3002"),(0,i.yg)("h3",{id:"oauth_path"},"oauth_path"),(0,i.yg)("p",null,"\u7528\u4e8e\u5411oauth\u670d\u52a1\u53d1\u9001\u8bf7\u6c42\u7684API,\u83b7\u53d6\u5bf9\u5e94\u7684\u8ba4\u8bc1\u4fe1\u606f\u3002\u6839\u636e\u63d0\u4f9b\u5546\u548c\u6240\u7528\u6a21\u578b\u7684\u4e0d\u540c\u53ef\u80fd\u6709\u6240\u53d8\u5316\u3002\u901a\u5e38\u7531\u6a21\u578b\u63d0\u4f9b\u5546\u63d0\u4f9b\u3002"),(0,i.yg)("h3",{id:"custom_config"},"custom_config"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"custom_config")," \u9009\u9879\u5141\u8bb8\u60a8\u4e3a\u6a21\u578b\u63d0\u4f9b\u989d\u5916\u7684\u81ea\u5b9a\u4e49\u914d\u7f6e\u3002\u8fd9\u662f\u4e00\u4e2a\u6620\u5c04\uff0c\u60a8\u53ef\u4ee5\u5728\u5176\u4e2d\u5b9a\u4e49\u7279\u5b9a\u6a21\u578b\u53ef\u80fd\u9700\u8981\u7684\u5404\u79cd\u8bbe\u7f6e\u3002"),(0,i.yg)("h3",{id:"custom_response_parse"},"custom_response_parse"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"custom_response_parse")," \u9009\u9879\u5141\u8bb8\u60a8\u6307\u5b9a\u5982\u4f55\u89e3\u6790\u6a21\u578b\u7684\u54cd\u5e94\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 JsonPath\n\u4ece\u54cd\u5e94\u4e2d\u63d0\u53d6\u6240\u9700\u7684\u7279\u5b9a\u6570\u636e\u3002\u4f8b\u5982\uff0c\u4f7f\u7528 ",(0,i.yg)("inlineCode",{parentName:"p"},"$.data[*].embedding")," \u63d0\u53d6\u5982\u4e0bjson\u4e2d\u7684 ",(0,i.yg)("inlineCode",{parentName:"p"},"embedding")," \u5b57\u6bb5\n\u503c,\u83b7\u53d6 ",(0,i.yg)("inlineCode",{parentName:"p"},"List")," \u5d4c\u5957 ",(0,i.yg)("inlineCode",{parentName:"p"},"List")," \u7684\u7ed3\u679c\u3002JsonPath\n\u7684\u4f7f\u7528\u8bf7\u53c2\u8003 ",(0,i.yg)("a",{parentName:"p",href:"https://github.com/json-path/JsonPath?tab=readme-ov-file#getting-started"},"JsonPath \u5feb\u901f\u5165\u95e8")),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "object": "list",\n  "data": [\n    {\n      "object": "embedding",\n      "index": 0,\n      "embedding": [\n        -0.006929283495992422,\n        -0.005336422007530928,\n        -0.00004547132266452536,\n        -0.024047505110502243\n      ]\n    }\n  ],\n  "model": "text-embedding-3-small",\n  "usage": {\n    "prompt_tokens": 5,\n    "total_tokens": 5\n  }\n}\n')),(0,i.yg)("h3",{id:"custom_request_headers"},"custom_request_headers"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"custom_request_headers")," \u9009\u9879\u5141\u8bb8\u60a8\u5b9a\u4e49\u5e94\u5305\u542b\u5728\u53d1\u9001\u5230\u6a21\u578b API \u7684\u8bf7\u6c42\u4e2d\u7684\u81ea\u5b9a\u4e49\u5934\u4fe1\u606f\u3002\u5982\u679c API\n\u9700\u8981\u6807\u51c6\u5934\u4fe1\u606f\u4e4b\u5916\u7684\u989d\u5916\u5934\u4fe1\u606f\uff0c\u4f8b\u5982\u6388\u6743\u4ee4\u724c\u3001\u5185\u5bb9\u7c7b\u578b\u7b49\uff0c\u8fd9\u4e2a\u9009\u9879\u4f1a\u975e\u5e38\u6709\u7528\u3002"),(0,i.yg)("h3",{id:"custom_request_body"},"custom_request_body"),(0,i.yg)("p",null,(0,i.yg)("inlineCode",{parentName:"p"},"custom_request_body")," \u9009\u9879\u652f\u6301\u5360\u4f4d\u7b26\uff1a"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"${model}"),"\uff1a\u7528\u4e8e\u6a21\u578b\u540d\u79f0\u7684\u5360\u4f4d\u7b26\u3002"),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"${input}"),"\uff1a\u7528\u4e8e\u786e\u5b9a\u8f93\u5165\u503c\u7684\u5360\u4f4d\u7b26,\u540c\u65f6\u6839\u636e body value \u7684\u7c7b\u578b\u5b9a\u4e49\u8bf7\u6c42\u4f53\u8bf7\u6c42\u7c7b\u578b\u3002\u4f8b\u5982\uff1a",(0,i.yg)("inlineCode",{parentName:"li"},'["${input}"]')," -> ",'["input"]'," (\nlist)\u3002")),(0,i.yg)("h3",{id:"common-options"},"common options"),(0,i.yg)("p",null,"\u8f6c\u6362\u63d2\u4ef6\u7684\u5e38\u89c1\u53c2\u6570, \u8bf7\u53c2\u8003  ",(0,i.yg)("a",{parentName:"p",href:"/zh-CN/docs/2.3.8/transform-v2/common-options"},"Transform Plugin")," \u4e86\u89e3\u8be6\u60c5"),(0,i.yg)("h2",{id:"\u793a\u4f8b\u914d\u7f6e"},"\u793a\u4f8b\u914d\u7f6e"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-hocon"},'env {\n  job.mode = "BATCH"\n}\n\nsource {\n  FakeSource {\n    row.num = 5\n    schema = {\n      fields {\n        book_id = "int"\n        book_name = "string"\n        book_intro = "string"\n        author_biography = "string"\n      }\n    }\n    rows = [\n      {fields = [1, "To Kill a Mockingbird",\n      "Set in the American South during the 1930s, To Kill a Mockingbird tells the story of young Scout Finch and her brother, Jem, who are growing up in a world of racial inequality and injustice. Their father, Atticus Finch, is a lawyer who defends a black man falsely accused of raping a white woman, teaching his children valuable lessons about morality, courage, and empathy.",\n      "Harper Lee (1926\u20132016) was an American novelist best known for To Kill a Mockingbird, which won the Pulitzer Prize in 1961. Lee was born in Monroeville, Alabama, and the town served as inspiration for the fictional Maycomb in her novel. Despite the success of her book, Lee remained a private person and published only one other novel, Go Set a Watchman, which was written before To Kill a Mockingbird but released in 2015 as a sequel."\n      ], kind = INSERT}\n      {fields = [2, "1984",\n      "1984 is a dystopian novel set in a totalitarian society governed by Big Brother. The story follows Winston Smith, a man who works for the Party rewriting history. Winston begins to question the Party\u2019s control and seeks truth and freedom in a society where individuality is crushed. The novel explores themes of surveillance, propaganda, and the loss of personal autonomy.",\n      "George Orwell (1903\u20131950) was the pen name of Eric Arthur Blair, an English novelist, essayist, journalist, and critic. Orwell is best known for his works 1984 and Animal Farm, both of which are critiques of totalitarian regimes. His writing is characterized by lucid prose, awareness of social injustice, opposition to totalitarianism, and support of democratic socialism. Orwell\u2019s work remains influential, and his ideas have shaped contemporary discussions on politics and society."\n      ], kind = INSERT}\n      {fields = [3, "Pride and Prejudice",\n      "Pride and Prejudice is a romantic novel that explores the complex relationships between different social classes in early 19th century England. The story centers on Elizabeth Bennet, a young woman with strong opinions, and Mr. Darcy, a wealthy but reserved gentleman. The novel deals with themes of love, marriage, and societal expectations, offering keen insights into human behavior.",\n      "Jane Austen (1775\u20131817) was an English novelist known for her sharp social commentary and keen observations of the British landed gentry. Her works, including Sense and Sensibility, Emma, and Pride and Prejudice, are celebrated for their wit, realism, and biting critique of the social class structure of her time. Despite her relatively modest life, Austen\u2019s novels have gained immense popularity, and she is considered one of the greatest novelists in the English language."\n      ], kind = INSERT}\n      {fields = [4, "The Great GatsbyThe Great Gatsby",\n      "The Great Gatsby is a novel about the American Dream and the disillusionment that can come with it. Set in the 1920s, the story follows Nick Carraway as he becomes entangled in the lives of his mysterious neighbor, Jay Gatsby, and the wealthy elite of Long Island. Gatsby\'s obsession with the beautiful Daisy Buchanan drives the narrative, exploring themes of wealth, love, and the decay of the American Dream.",\n      "F. Scott Fitzgerald (1896\u20131940) was an American novelist and short story writer, widely regarded as one of the greatest American writers of the 20th century. Born in St. Paul, Minnesota, Fitzgerald is best known for his novel The Great Gatsby, which is often considered the quintessential work of the Jazz Age. His works often explore themes of youth, wealth, and the American Dream, reflecting the turbulence and excesses of the 1920s."\n      ], kind = INSERT}\n      {fields = [5, "Moby-Dick",\n      "Moby-Dick is an epic tale of obsession and revenge. The novel follows the journey of Captain Ahab, who is on a relentless quest to kill the white whale, Moby Dick, that once maimed him. Narrated by Ishmael, a sailor aboard Ahab\u2019s ship, the story delves into themes of fate, humanity, and the struggle between man and nature. The novel is also rich with symbolism and philosophical musings.",\n      "Herman Melville (1819\u20131891) was an American novelist, short story writer, and poet of the American Renaissance period. Born in New York City, Melville gained initial fame with novels such as Typee and Omoo, but it was Moby-Dick, published in 1851, that would later be recognized as his masterpiece. Melville\u2019s work is known for its complexity, symbolism, and exploration of themes such as man\u2019s place in the universe, the nature of evil, and the quest for meaning. Despite facing financial difficulties and critical neglect during his lifetime, Melville\u2019s reputation soared posthumously, and he is now considered one of the great American authors."\n      ], kind = INSERT}\n    ]\n    result_table_name = "fake"\n  }\n}\n\ntransform {\n  Embedding {\n    source_table_name = "fake"\n    embedding_model_provider = QIANFAN\n    model = bge_large_en\n    api_key = xxxxxxxxxx\n    secret_key = xxxxxxxxxx\n    api_path = xxxxxxxxxx\n    vectorization_fields {\n        book_intro_vector = book_intro\n        author_biography_vector  = author_biography\n    }\n    result_table_name = "embedding_output"\n  }\n}\n\nsink {\n  Assert {\n      source_table_name = "embedding_output"\n\n\n      rules =\n        {\n          field_rules = [\n            {\n              field_name = book_id\n              field_type = int\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            },\n            {\n              field_name = book_name\n              field_type = string\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            },\n            {\n              field_name = book_intro\n              field_type = string\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            },\n            {\n              field_name = author_biography\n              field_type = string\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            },\n            {\n              field_name = book_intro_vector\n              field_type = float_vector\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            },\n            {\n              field_name = author_biography_vector\n              field_type = float_vector\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            }\n          ]\n        }\n    }\n}\n')),(0,i.yg)("h3",{id:"customize-the-embedding-model"},"Customize the embedding model"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-hocon"},'\nenv {\n  job.mode = "BATCH"\n}\n\nsource {\n  FakeSource {\n    row.num = 5\n    schema = {\n      fields {\n        book_id = "int"\n        book_name = "string"\n        book_intro = "string"\n        author_biography = "string"\n      }\n    }\n    rows = [\n      {fields = [1, "To Kill a Mockingbird",\n      "Set in the American South during the 1930s, To Kill a Mockingbird tells the story of young Scout Finch and her brother, Jem, who are growing up in a world of racial inequality and injustice. Their father, Atticus Finch, is a lawyer who defends a black man falsely accused of raping a white woman, teaching his children valuable lessons about morality, courage, and empathy.",\n      "Harper Lee (1926\u20132016) was an American novelist best known for To Kill a Mockingbird, which won the Pulitzer Prize in 1961. Lee was born in Monroeville, Alabama, and the town served as inspiration for the fictional Maycomb in her novel. Despite the success of her book, Lee remained a private person and published only one other novel, Go Set a Watchman, which was written before To Kill a Mockingbird but released in 2015 as a sequel."\n      ], kind = INSERT}\n      {fields = [2, "1984",\n      "1984 is a dystopian novel set in a totalitarian society governed by Big Brother. The story follows Winston Smith, a man who works for the Party rewriting history. Winston begins to question the Party\u2019s control and seeks truth and freedom in a society where individuality is crushed. The novel explores themes of surveillance, propaganda, and the loss of personal autonomy.",\n      "George Orwell (1903\u20131950) was the pen name of Eric Arthur Blair, an English novelist, essayist, journalist, and critic. Orwell is best known for his works 1984 and Animal Farm, both of which are critiques of totalitarian regimes. His writing is characterized by lucid prose, awareness of social injustice, opposition to totalitarianism, and support of democratic socialism. Orwell\u2019s work remains influential, and his ideas have shaped contemporary discussions on politics and society."\n      ], kind = INSERT}\n      {fields = [3, "Pride and Prejudice",\n      "Pride and Prejudice is a romantic novel that explores the complex relationships between different social classes in early 19th century England. The story centers on Elizabeth Bennet, a young woman with strong opinions, and Mr. Darcy, a wealthy but reserved gentleman. The novel deals with themes of love, marriage, and societal expectations, offering keen insights into human behavior.",\n      "Jane Austen (1775\u20131817) was an English novelist known for her sharp social commentary and keen observations of the British landed gentry. Her works, including Sense and Sensibility, Emma, and Pride and Prejudice, are celebrated for their wit, realism, and biting critique of the social class structure of her time. Despite her relatively modest life, Austen\u2019s novels have gained immense popularity, and she is considered one of the greatest novelists in the English language."\n      ], kind = INSERT}\n      {fields = [4, "The Great GatsbyThe Great Gatsby",\n      "The Great Gatsby is a novel about the American Dream and the disillusionment that can come with it. Set in the 1920s, the story follows Nick Carraway as he becomes entangled in the lives of his mysterious neighbor, Jay Gatsby, and the wealthy elite of Long Island. Gatsby\'s obsession with the beautiful Daisy Buchanan drives the narrative, exploring themes of wealth, love, and the decay of the American Dream.",\n      "F. Scott Fitzgerald (1896\u20131940) was an American novelist and short story writer, widely regarded as one of the greatest American writers of the 20th century. Born in St. Paul, Minnesota, Fitzgerald is best known for his novel The Great Gatsby, which is often considered the quintessential work of the Jazz Age. His works often explore themes of youth, wealth, and the American Dream, reflecting the turbulence and excesses of the 1920s."\n      ], kind = INSERT}\n      {fields = [5, "Moby-Dick",\n      "Moby-Dick is an epic tale of obsession and revenge. The novel follows the journey of Captain Ahab, who is on a relentless quest to kill the white whale, Moby Dick, that once maimed him. Narrated by Ishmael, a sailor aboard Ahab\u2019s ship, the story delves into themes of fate, humanity, and the struggle between man and nature. The novel is also rich with symbolism and philosophical musings.",\n      "Herman Melville (1819\u20131891) was an American novelist, short story writer, and poet of the American Renaissance period. Born in New York City, Melville gained initial fame with novels such as Typee and Omoo, but it was Moby-Dick, published in 1851, that would later be recognized as his masterpiece. Melville\u2019s work is known for its complexity, symbolism, and exploration of themes such as man\u2019s place in the universe, the nature of evil, and the quest for meaning. Despite facing financial difficulties and critical neglect during his lifetime, Melville\u2019s reputation soared posthumously, and he is now considered one of the great American authors."\n      ], kind = INSERT}\n    ]\n    result_table_name = "fake"\n  }\n}\n\ntransform {\n Embedding {\n    source_table_name = "fake"\n    model_provider = CUSTOM\n    model = text-embedding-3-small\n    api_key = xxxxxxxx\n    api_path = "http://mockserver:1080/v1/doubao/embedding"\n    single_vectorized_input_number = 2\n    vectorization_fields {\n        book_intro_vector = book_intro\n        author_biography_vector  = author_biography\n    }\n    custom_config={\n        custom_response_parse = "$.data[*].embedding"\n        custom_request_headers = {\n            "Content-Type"= "application/json"\n            "Authorization"= "Bearer xxxxxxx\n        }\n        custom_request_body ={\n            modelx = "${model}"\n            inputx = ["${input}"]\n        }\n    }\n    result_table_name = "embedding_output_1"\n  }\n}\n\nsink {\n  Assert {\n      source_table_name = "embedding_output_1"\n      rules =\n        {\n          field_rules = [\n            {\n              field_name = book_id\n              field_type = int\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            },\n            {\n              field_name = book_name\n              field_type = string\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            },\n            {\n              field_name = book_intro\n              field_type = string\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            },\n            {\n              field_name = author_biography\n              field_type = string\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            },\n            {\n              field_name = book_intro_vector\n              field_type = float_vector\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            },\n            {\n              field_name = author_biography_vector\n              field_type = float_vector\n              field_value = [\n                {\n                  rule_type = NOT_NULL\n                }\n              ]\n            }\n          ]\n        }\n    }\n}\n\n')))}g.isMDXComponent=!0}}]);