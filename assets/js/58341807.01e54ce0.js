"use strict";(self.webpackChunkseatunnel_website=self.webpackChunkseatunnel_website||[]).push([[16413],{15680:(e,n,t)=>{t.d(n,{xA:()=>c,yg:()=>y});var a=t(96540);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=a.createContext({}),u=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=u(e.components);return a.createElement(l.Provider,{value:n},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},g=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(t),g=o,y=p["".concat(l,".").concat(g)]||p[g]||m[g]||r;return t?a.createElement(y,i(i({ref:n},c),{},{components:t})):a.createElement(y,i({ref:n},c))}));function y(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,i=new Array(r);i[0]=g;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[p]="string"==typeof e?e:o,i[1]=s;for(var u=2;u<r;u++)i[u]=t[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}g.displayName="MDXCreateElement"},69365:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>u});var a=t(58168),o=(t(96540),t(15680));const r={sidebar_position:15},i="Tuning Guide",s={unversionedId:"seatunnel-engine/tuning-guide",id:"seatunnel-engine/tuning-guide",title:"Tuning Guide",description:"This article introduces the tuning methods of SeaTunnel Engine to help users optimize the performance and stability of SeaTunnel Engine according to their actual needs.",source:"@site/docs/seatunnel-engine/tuning-guide.md",sourceDirName:"seatunnel-engine",slug:"/seatunnel-engine/tuning-guide",permalink:"/docs/seatunnel-engine/tuning-guide",draft:!1,editUrl:"https://github.com/apache/seatunnel-website/edit/main/docs/seatunnel-engine/tuning-guide.md",tags:[],version:"current",sidebarPosition:15,frontMatter:{sidebar_position:15},sidebar:"docs",previous:{title:"Slot Allocation Strategy",permalink:"/docs/seatunnel-engine/slot-allocation-strategy"},next:{title:"Seatunnel Runs On Flink",permalink:"/docs/other-engine/flink"}},l={},u=[{value:"Cluster Slow Response or Hang",id:"cluster-slow-response-or-hang",level:2},{value:"JVM",id:"jvm",level:3},{value:"Insufficient Heap Memory",id:"insufficient-heap-memory",level:4},{value:"Troubleshooting Process",id:"troubleshooting-process",level:5},{value:"Solutions",id:"solutions",level:5},{value:"Unlimited Memory Usage",id:"unlimited-memory-usage",level:5},{value:"High CPU Usage",id:"high-cpu-usage",level:4},{value:"Troubleshooting Process",id:"troubleshooting-process-1",level:5},{value:"Solutions",id:"solutions-1",level:5},{value:"Hazelcast",id:"hazelcast",level:3}],c={toc:u},p="wrapper";function m(e){let{components:n,...t}=e;return(0,o.yg)(p,(0,a.A)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,o.yg)("h1",{id:"tuning-guide"},"Tuning Guide"),(0,o.yg)("p",null,"This article introduces the tuning methods of SeaTunnel Engine to help users optimize the performance and stability of SeaTunnel Engine according to their actual needs.\nBefore reading this guide, please note that the recommendations here are summarized from real-world usage by most users and may not be suitable for all scenarios. You can adjust them according to your actual situation."),(0,o.yg)("p",null,"SeaTunnel Engine is a data integration engine running on the ",(0,o.yg)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Java_virtual_machine"},"JVM"),", so JVM tuning is also applicable to SeaTunnel Engine and will not be repeated here."),(0,o.yg)("h2",{id:"cluster-slow-response-or-hang"},"Cluster Slow Response or Hang"),(0,o.yg)("h3",{id:"jvm"},"JVM"),(0,o.yg)("p",null,"If the SeaTunnel Engine cluster responds slowly or hangs, it may be due to insufficient JVM heap memory. You can troubleshoot as follows:"),(0,o.yg)("h4",{id:"insufficient-heap-memory"},"Insufficient Heap Memory"),(0,o.yg)("h5",{id:"troubleshooting-process"},"Troubleshooting Process"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"Check JVM heap memory usage in real time\nUse the ",(0,o.yg)("inlineCode",{parentName:"li"},"jcmd")," command to check JVM heap memory usage, where ",(0,o.yg)("inlineCode",{parentName:"li"},"<pid>")," is the PID of the SeaTunnel Engine process.",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"jmap -heap <pid>\n")),"Example output:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-shell"}," Attaching to process ID 2111950, please wait...\n Debugger attached successfully.\n Server compiler detected.\n JVM version is 25.192-b12\n \n using thread-local object allocation.\n Garbage-First (G1) GC with 13 thread(s)\n \n Heap Configuration:\n MinHeapFreeRatio         = 40\n MaxHeapFreeRatio         = 70\n MaxHeapSize              = 17179869184 (16384.0MB)\n NewSize                  = 1363144 (1.2999954223632812MB)\n MaxNewSize               = 10301210624 (9824.0MB)\n OldSize                  = 5452592 (5.1999969482421875MB)\n NewRatio                 = 2\n SurvivorRatio            = 8\n MetaspaceSize            = 21807104 (20.796875MB)\n CompressedClassSpaceSize = 1073741824 (1024.0MB)\n MaxMetaspaceSize         = 2147483648 (2048.0MB)\n G1HeapRegionSize         = 8388608 (8.0MB)\n \n Heap Usage:\n G1 Heap:\n regions  = 2048\n capacity = 17179869184 (16384.0MB)\n used     = 2997548048 (2858.684585571289MB)\n free     = 14182321136 (13525.315414428711MB)\n 17.448026034981012% used\n G1 Young Generation:\n Eden Space:\n regions  = 348\n capacity = 10737418240 (10240.0MB)\n used     = 2919235584 (2784.0MB)\n free     = 7818182656 (7456.0MB)\n 27.1875% used\n Survivor Space:\n regions  = 10\n capacity = 83886080 (80.0MB)\n used     = 83886080 (80.0MB)\n free     = 0 (0.0MB)\n 100.0% used\n G1 Old Generation:\n regions  = 0\n capacity = 6358564864 (6064.0MB)\n used     = 0 (0.0MB)\n free     = 6358564864 (6064.0MB)\n 0.0% used\n")),"Pay attention to the usage of G1 Old Generation. If the usage rate of Old Generation is close to 100%, it may be caused by insufficient heap memory."),(0,o.yg)("li",{parentName:"ol"},"Check the logs\nThe system will periodically output health monitoring logs. Check the SeaTunnel Engine logs to see if there are frequent Full GCs or long GC pauses, which may be caused by insufficient heap memory.\nExample log:",(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-log"},"[] 2025-07-04 16:42:54,818 INFO  [c.h.i.d.HealthMonitor         ] [hz.main.HealthMonitor] - [127.0.0.1]:5801 [seatunnel] [5.1] processors=16, physical.memory.total=31.1G, physical.memory.free=9.7G, swap.space.total=0, swap.space.free=0, heap.memory.used=198.7M, heap.memory.free=15.8G, heap.memory.total=16.0G, heap.memory.max=16.0G, heap.memory.used/total=1.21%, heap.memory.used/max=1.21%, minor.gc.count=2, minor.gc.time=44ms, major.gc.count=0, major.gc.time=0ms, load.process=0.00%, load.system=66.67%, load.systemAverage=5.66, thread.count=118, thread.peakCount=118, cluster.timeDiff=0, event.q.size=0, executor.q.async.size=0, executor.q.client.size=0, executor.q.client.query.size=0, executor.q.client.blocking.size=0, executor.q.query.size=0, executor.q.scheduled.size=0, executor.q.io.size=0, executor.q.system.size=0, executor.q.operations.size=0, executor.q.priorityOperation.size=0, operations.completed.count=13, executor.q.mapLoad.size=0, executor.q.mapLoadAllKeys.size=0, executor.q.cluster.size=0, executor.q.response.size=0, operations.running.count=0, operations.pending.invocations.percentage=0.00%, operations.pending.invocations.count=0, proxy.count=9, clientEndpoint.count=0, connection.active.count=0, client.connection.count=0, connection.count=0\n")),"Focus on:",(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"heap.memory.used/max"),": Heap memory usage rate. If it is close to 100%, it may be due to insufficient heap memory."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"major.gc.count")," and ",(0,o.yg)("inlineCode",{parentName:"li"},"major.gc.time"),": If Full GC is frequent, it may be caused by insufficient heap memory.\nYou can judge whether there are frequent Full GCs or long GC pauses by continuously checking the logs.")))),(0,o.yg)("h5",{id:"solutions"},"Solutions"),(0,o.yg)("p",null,"Reduce memory usage at the same time by lowering task concurrency and the number of tasks. If you do need more memory, please refer to ",(0,o.yg)("a",{parentName:"p",href:"/docs/seatunnel-engine/deployment"},"Deployment")," for configuring SeaTunnel Engine JVM options to increase memory."),(0,o.yg)("h5",{id:"unlimited-memory-usage"},"Unlimited Memory Usage"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Generate a memory snapshot"),(0,o.yg)("p",{parentName:"li"},"Sometimes, even with a fixed number of tasks, memory usage keeps increasing, which may be caused by a memory leak in the task. Please dump the corresponding memory snapshot information."),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"jmap -dump:live,format=b,file=heap.hprof <pid>\n")),(0,o.yg)("p",{parentName:"li"},"Then use tools such as ",(0,o.yg)("a",{parentName:"p",href:"https://www.eclipse.org/mat/"},"Eclipse Memory Analyzer")," to analyze the memory snapshot and find the cause of the memory leak.\nFor users or connectors who are not secondary developers, you can also create an issue and attach the memory snapshot, and we will help you analyze it.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Print object occupancy ranking"),(0,o.yg)("p",{parentName:"li"},"Sometimes, generating a memory snapshot may fail due to JVM hang. In this case, you can try to print the object occupancy ranking to check memory usage."),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"jmap -histo:live <pid> | head -n 100\n")),(0,o.yg)("p",{parentName:"li"},"Similarly, you can analyze the output to find the cause of the memory leak.\nFor users or connectors who are not secondary developers, you can also create an issue and attach the object occupancy information, and we will help you analyze it."))),(0,o.yg)("h4",{id:"high-cpu-usage"},"High CPU Usage"),(0,o.yg)("p",null,"High CPU usage is also a common cause of cluster node hangs, but it is less likely than high memory usage. You can troubleshoot as follows:"),(0,o.yg)("h5",{id:"troubleshooting-process-1"},"Troubleshooting Process"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"Check CPU usage",(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},"Use the ",(0,o.yg)("inlineCode",{parentName:"li"},"top")," or ",(0,o.yg)("inlineCode",{parentName:"li"},"htop")," command to check the CPU usage of the SeaTunnel Engine process."),(0,o.yg)("li",{parentName:"ul"},"If the CPU usage is close to 100%, it may be due to insufficient CPU resources. If there are multiple cores, consider the usage of all cores.")))),(0,o.yg)("h5",{id:"solutions-1"},"Solutions"),(0,o.yg)("p",null,"If CPU usage is too high, you can try the following solutions:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Reduce task concurrency and the number of tasks to reduce CPU resource usage."),(0,o.yg)("li",{parentName:"ul"},"Increase the number of cluster nodes to share the CPU resource load.")),(0,o.yg)("h3",{id:"hazelcast"},"Hazelcast"),(0,o.yg)("p",null,"Hazelcast-related configuration is also an important factor affecting the performance of SeaTunnel Engine. You can modify the configuration parameters in the ",(0,o.yg)("inlineCode",{parentName:"p"},"hazelcast.yaml")," series of files. Please refer to ",(0,o.yg)("a",{parentName:"p",href:"/docs/seatunnel-engine/deployment"},"Deployment"),".\nHere are some common tuning parameters:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"hazelcast.operation.generic.thread.count"),": This parameter controls the number of generic operation threads in Hazelcast. SeaTunnel Engine uses this thread for executing RPC requests. You can adjust this parameter according to your actual situation to improve the performance of Hazelcast RPC.\nIf you frequently see logs like the following and the CPU usage is not very high, try increasing this parameter:")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-log"},"2024-09-03 06:15:45,807 WARN  [.s.i.o.s.SlowOperationDetector] [hz.main.SlowOperationDetectorThread] - [seatunnel-worker-1]:5802 [seatunnel] [5.1] Slow operation detected:\n")))}m.isMDXComponent=!0}}]);